# Telkom Network Analytics - Dataset Schemas

This document outlines all datasets generated by the `historicaldata_extended.py` script and their corresponding schemas.

## Overview

- **Total Datasets:** 11
- **Total Records:** ~13.8 million records across all datasets
- **Date Range:** July 1, 2025 to August 20, 2025
- **Regions:** 9 South African provinces
- **Storage Format:** Parquet files partitioned by year/month/day
- **Tower Network:** 15,000 towers with deterministic relationships

## Dataset Schemas

### 1. Tower Locations
**Path:** `abfss://raw@dlstelkomnetworkprod.dfs.core.windows.net/tower_locations`  
**Records:** ~15,000

| Column | Data Type | Description |
|--------|-----------|-------------|
| `tower_id` | string | Generated from range ID (0-14999) |
| `latitude` | double | Random value between 22-29 degrees |
| `longitude` | double | Random value between 16-25 degrees |
| `region` | string | One of 9 South African regions |
| `region_index` | int | Hash-based region mapping (0-8) |
| `tower_index` | int | Row number for indexing (0-14999) |

**Regions:**
- Gauteng, KwaZulu-Natal, Western Cape, Eastern Cape, Free State, Mpumalanga, Northern Cape, Limpopo, North West

---

### 2. Network Logs
**Path:** `abfss://raw@dlstelkomnetworkprod.dfs.core.windows.net/network_logs`  
**Records:** ~6,000,000

| Column | Data Type | Description |
|--------|-----------|-------------|
| `tower_id` | string | Reference to tower locations |
| `signal_strength` | double | Random 0-100, adjusted for low values (<20 gets 0.8x multiplier) |
| `latency_ms` | double | Random 0-10 milliseconds |
| `timestamp` | timestamp | Random between 2025-07-01 and 2025-08-20 |
| `uptime` | double | Random 95-100 percent |
| `error_codes` | string | NULL (94%), 'E001', or 'E002' (3% each) |
| `year` | int | Extracted from timestamp (2025) |
| `month` | int | Extracted from timestamp (7-8) |
| `day` | int | Extracted from timestamp (1-31) |
| `region` | string | Derived from tower_id |

---

### 3. Weather Data
**Path:** `abfss://raw@dlstelkomnetworkprod.dfs.core.windows.net/weather_data`  
**Records:** ~Variable (based on network logs unique tower-timestamp combinations)

| Column | Data Type | Description |
|--------|-----------|-------------|
| `tower_id` | string | Reference to tower locations |
| `timestamp` | timestamp | From network logs timestamps |
| `temperature_c` | double | Random 20-35°C |
| `humidity_percent` | double | Random 40-80% |
| `wind_speed_mps` | double | Random 0-10 m/s |
| `weather_condition` | string | 'Rain' (20%), 'Clouds' (30%), 'Clear' (50%) |
| `visibility_km` | double | Random 0-10 km |
| `year` | int | Extracted from timestamp |
| `month` | int | Extracted from timestamp |
| `day` | int | Extracted from timestamp |
| `region` | string | Derived from tower_id |

---

### 4. Customer Usage
**Path:** `abfss://raw@dlstelkomnetworkprod.dfs.core.windows.net/customer_usage`  
**Records:** ~6,000,000

| Column | Data Type | Description |
|--------|-----------|-------------|
| `customer_id` | string | Generated from range ID (0-5999999) |
| `data_usage_mb` | double | Random 0-1000, boosted 1.2x for values >800 |
| `call_duration_min` | double | Random 0-60 minutes |
| `timestamp` | timestamp | Random between 2025-07-01 and 2025-08-20 |
| `data_usage` | double | Alias for data_usage_mb |
| `call_duration` | double | Alias for call_duration_min |
| `tower_id` | string | Deterministically assigned based on customer_id hash |
| `year` | int | Extracted from timestamp |
| `month` | int | Extracted from timestamp |
| `day` | int | Extracted from timestamp |

---

### 5. Load Shedding Schedules
**Path:** `abfss://raw@dlstelkomnetworkprod.dfs.core.windows.net/load_shedding_schedules`  
**Records:** ~20,000

| Column | Data Type | Description |
|--------|-----------|-------------|
| `region` | string | One of 9 South African regions |
| `start_time` | timestamp | Random between 2025-07-01 and 2025-08-20 |
| `end_time` | timestamp | 1-4 hours after start_time |
| `tower_id` | string | Deterministically selected tower within region |
| `year` | int | Extracted from start_time |
| `month` | int | Extracted from start_time |
| `day` | int | Extracted from start_time |

---

### 6. Customer Feedback
**Path:** `abfss://raw@dlstelkomnetworkprod.dfs.core.windows.net/customer_feedback`  
**Records:** ~1,000,000

| Column | Data Type | Description |
|--------|-----------|-------------|
| `text` | string | One of 10 predefined feedback messages |
| `sentiment_score` | double | Random -1 to 1, rounded to 3 decimals |
| `timestamp` | timestamp | Random between 2025-07-01 and 2025-08-20 |
| `sentiment_label` | string | 'negative' (<-0.2), 'neutral' (-0.2 to 0.2), 'positive' (>0.2) |
| `tower_id` | string | Deterministically assigned based on text+timestamp hash |
| `year` | int | Extracted from timestamp |
| `month` | int | Extracted from timestamp |
| `day` | int | Extracted from timestamp |

**Feedback Messages:**
- "Network is slow in my area"
- "Frequent dropped calls"
- "No coverage inside my building"
- "High latency during peak hours"
- "Billing issue with last invoice"
- "SIM card not working"
- "App keeps crashing"
- "Unexpected charges on my account"
- "Activation is delayed"
- "Roaming does not work"

---

### 7. Tower Imagery
**Path:** `abfss://raw@dlstelkomnetworkprod.dfs.core.windows.net/tower_imagery`  
**Records:** ~15,000

| Column | Data Type | Description |
|--------|-----------|-------------|
| `tower_id` | string | Reference to all tower locations |
| `timestamp` | timestamp | Random between 2025-07-01 and 2025-08-20 |
| `image_path` | string | Generated path: `abfss://raw@.../assets/tower_images/{tower_id}/{unix_timestamp}.jpg` |
| `condition_label` | string | 'OK', 'Minor', or 'Critical' (equal probability) |
| `year` | int | Extracted from timestamp |
| `month` | int | Extracted from timestamp |
| `day` | int | Extracted from timestamp |

---

### 8. Voice Transcriptions
**Path:** `abfss://raw@dlstelkomnetworkprod.dfs.core.windows.net/voice_transcriptions`  
**Records:** ~120,000

| Column | Data Type | Description |
|--------|-----------|-------------|
| `technician_id` | string | Generated from range ID (0-119999) |
| `transcription` | string | One of 10 predefined maintenance messages |
| `timestamp` | timestamp | Random between 2025-07-01 and 2025-08-20 |
| `tower_id` | string | Deterministically assigned based on technician_id hash |
| `year` | int | Extracted from timestamp |
| `month` | int | Extracted from timestamp |
| `day` | int | Extracted from timestamp |

**Transcription Messages:**
- "Start site inspection"
- "Check signal levels"
- "Replace faulty antenna"
- "Confirm power status"
- "Log maintenance complete"
- "Escalate to network ops"
- "Verify backhaul link"
- "Capture tower imagery"
- "Run diagnostic test"
- "Close the ticket"

---

### 9. Tower Connectivity
**Path:** `abfss://raw@dlstelkomnetworkprod.dfs.core.windows.net/tower_connectivity`  
**Records:** ~30,000 (2 neighbors per tower)

| Column | Data Type | Description |
|--------|-----------|-------------|
| `src_tower_id` | string | Source tower reference |
| `dst_tower_id` | string | Destination tower reference (sequential neighbors) |
| `signal_quality` | double | Random 0-100 |
| `timestamp` | timestamp | Random between 2025-07-01 and 2025-08-20 |
| `year` | int | Extracted from timestamp |
| `month` | int | Extracted from timestamp |
| `day` | int | Extracted from timestamp |

**Note:** Each tower connects to its next 2 sequential neighbors in a circular topology.

---

### 10. Tower Capacity
**Path:** `abfss://raw@dlstelkomnetworkprod.dfs.core.windows.net/tower_capacity`  
**Records:** ~15,000

| Column | Data Type | Description |
|--------|-----------|-------------|
| `tower_id` | string | Reference to tower locations |
| `capacity_mbps` | double | Random 100-1000 Mbps |
| `utilization_percent` | double | Random 10-90% |
| `timestamp` | timestamp | Random between 2025-07-01 and 2025-08-20 |
| `year` | int | Extracted from timestamp |
| `month` | int | Extracted from timestamp |
| `day` | int | Extracted from timestamp |

---

### 11. Maintenance Crew
**Path:** `abfss://raw@dlstelkomnetworkprod.dfs.core.windows.net/maintenance_crew`  
**Records:** ~5,000

| Column | Data Type | Description |
|--------|-----------|-------------|
| `crew_id` | string | Generated from range ID (0-4999) |
| `region` | string | One of 9 South African regions |
| `latitude` | double | Random 22-29 degrees |
| `longitude` | double | Random 16-25 degrees |
| `available` | boolean | 70% chance of being available |
| `shift_start` | timestamp | Random between 2025-07-01 and 2025-08-20 |
| `shift_end` | timestamp | 8 hours after shift_start |
| `tower_id` | string | Deterministically selected tower within region |
| `year` | int | Extracted from shift_start |
| `month` | int | Extracted from shift_start |
| `day` | int | Extracted from shift_start |

---

## Data Relationships

### Primary Relationships
- **Tower Locations** → Central hub for all other datasets
- **Network Logs** → Tower Locations (via tower_id)
- **Weather Data** → Derived from Network Logs (tower_id + timestamp combinations)
- **Customer Usage** → Tower Locations (via deterministic hash mapping)
- **Load Shedding** → Tower Locations (via region-based selection)
- **Customer Feedback** → Tower Locations (via deterministic hash mapping)
- **Tower Imagery** → Tower Locations (one-to-one mapping)
- **Voice Transcriptions** → Tower Locations (via deterministic hash mapping)
- **Tower Connectivity** → Tower Locations (source and destination towers)
- **Tower Capacity** → Tower Locations (one-to-one mapping)
- **Maintenance Crew** → Tower Locations (via region-based selection)

### Data Generation Strategy
- **Deterministic Relationships:** Uses hash functions to ensure consistent tower assignments
- **Regional Distribution:** Evenly distributes data across 9 South African provinces
- **Temporal Consistency:** All timestamps fall within the specified 51-day period
- **Realistic Distributions:** Applies business logic (e.g., signal strength adjustments, error rates)

## Storage Details

- **Format:** Apache Parquet
- **Partitioning:** By year, month, and day
- **Coalescing:** Single file per partition to optimize query performance
- **File Naming:** Custom naming convention (part-xxxxx-tid.parquet)
- **Storage Location:** Azure Data Lake Storage (ABFSS)
